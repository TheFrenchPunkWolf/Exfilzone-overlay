<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Exfilzone Control</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  background:#050505;
  color:white;
  font-family:Arial Black, sans-serif;
  text-align:center;
  margin:0;
}
h1{
  color:#ff3cac;
  text-shadow:0 0 15px #ff3cac,0 0 30px #2bd2ff;
}
.hidden{display:none}
.stat{
  font-size:48px;
  margin:20px;
}
button{
  font-size:42px;
  width:180px;
  height:180px;
  margin:10px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,#ff3cac,#2bd2ff);
  box-shadow:0 0 20px #2bd2ff;
}
.raid{width:380px}
.reset{
  background:linear-gradient(135deg,#ff004c,#ff3cac);
}
</style>
</head>

<body>
<h1>âš”ï¸ EXFILZONE</h1>

<!-- PIN -->
<div id="lock">
  <h2>ğŸ”’ PIN</h2>
  <input id="pinInput" type="password" style="font-size:40px;width:200px">
  <br><br>
  <button onclick="checkPin()">OK</button>
</div>

<!-- PANEL -->
<div id="panel" class="hidden">

<div class="stat">ğŸ”¥ KILLS <span id="kills">0</span></div>
<button onclick="inc('kills')">+</button>

<div class="stat">ğŸ’€ MORTS <span id="deaths">0</span></div>
<button onclick="inc('deaths')">+</button>

<div class="stat">â± RAID <span id="timer">00:00</span></div>

<button class="raid" onclick="startRaid()">ğŸŸ¢ DÃ‰BUT DU RAID</button>
<button class="raid" onclick="endRaid()">ğŸš© RAID TERMINÃ‰</button>

<div class="stat">ğŸ¯ RAIDS <span id="raids">0</span></div>
<div class="stat">ğŸ“Š K/D <span id="kd">0.00</span></div>

<br>
<button class="raid reset" onclick="resetSession()">â˜¢ RESET SESSION</button>

</div>

<script>
// ğŸ”¥ FIREBASE CONFIG (remplace par les tiennes)
firebase.initializeApp({
  apiKey: "AIzaSyCfIO5AIHqXT8m134ynF8dr5t-SfNNjA8k",
  databaseURL: "https://exfilzone-overlay-default-rtdb.europe-west1.firebasedatabase.app"
});
const ref = firebase.database().ref("exfilzone");

let raidStart = 0;

// PIN
function checkPin(){
  ref.child("pin").once("value", s=>{
    if(pinInput.value === s.val()){
      lock.classList.add("hidden");
      panel.classList.remove("hidden");
    }
  });
}

// STATS
function inc(k){
  ref.child(k).transaction(v=>(v||0)+1);
}

// RAID
function startRaid(){
  ref.child("raidStart").set(Date.now());
}
function endRaid(){
  ref.child("raids").transaction(v=>(v||0)+1);
  ref.child("raidStart").set(0);
}

// RESET
function resetSession(){
  if(confirm("Reset session ?")){
    ref.update({kills:0,deaths:0,raids:0,raidStart:0});
  }
}

// SYNC
ref.on("value", s=>{
  const d=s.val()||{};
  kills.innerText=d.kills||0;
  deaths.innerText=d.deaths||0;
  raids.innerText=d.raids||0;
  raidStart=d.raidStart||0;
  kd.innerText=((d.deaths?d.kills/d.deaths:d.kills)||0).toFixed(2);
});

// TIMER LIVE
function updateTimer(){
  if(!raidStart){
    timer.innerText="00:00";
  }else{
    const t=Math.floor((Date.now()-raidStart)/1000);
    timer.innerText=
      String(Math.floor(t/60)).padStart(2,"0")+":"+
      String(t%60).padStart(2,"0");
  }
  requestAnimationFrame(updateTimer);
}
updateTimer();
</script>
</body>
</html>

